"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
exports.lineRegex = /(\S+)\s+(\S+)\s+\[([^\]]*)\]\s+\/(.*)\/\s*$/;
function parse(contents) {
    const definitions = [];
    const lines = contents.split('\n');
    lines.forEach((line, i) => {
        if (line.startsWith('#') || line === '')
            return; // skip comments and blanks
        const match = exports.lineRegex.exec(line);
        if (match !== null)
            definitions.push({
                traditional: match[1],
                simplified: match[2],
                pronunciation: match[3],
                definitions: match[4].split('/')
            });
        else
            process.stderr.write(`Invalid line format ${i + 1}: ${line}\n`);
    });
    return definitions;
}
exports.parse = parse;
function parseFile(filename) {
    const contents = fs_1.readFileSync(filename, 'utf-8');
    return parse(contents);
}
exports.parseFile = parseFile;
